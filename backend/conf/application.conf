# https://www.playframework.com/documentation/latest/Configuration
# Application Configuration
app {
  env = "development"
  env = ${?APP_ENV}
  domain = "localhost"
  domain = ${?APP_DOMAIN}
}

client {
  url = "http://localhost:3000"
  url = ${?CLIENT_URL}
}

# Server configuration
play.server.http.port = 9000
play.server.http.port = ${?PORT}

# Include Google OAuth2 client configuration
include "google-oauth2-client.conf"

# Include security configuration
include "security.conf"

# Enable modules
play.modules.enabled += "modules.SecurityModule"
play.modules.enabled += "modules.DatabaseModule"
play.modules.enabled += "modules.ActorsModule"

# Enable filters
play.filters.enabled += "play.filters.gzip.GzipFilter"

play.http.secret.key = "j2kf02kd92kslf930r9wkj3sd09c1slcf03sdm29"
play.http.secret.key = ${?PLAY_SECRET}

# Database configuration
slick.dbs.default.profile = "slick.jdbc.PostgresProfile$"
slick.dbs.default.db.driver = "org.postgresql.Driver"
slick.dbs.default.db.url = "jdbc:postgresql://localhost:5432/smart_taskhub"
slick.dbs.default.db.url = ${?DB_URL}
slick.dbs.default.db.user = "postgres"
slick.dbs.default.db.user = ${?DB_USER}
slick.dbs.default.db.password = "admin"
slick.dbs.default.db.password = ${?DB_PASSWORD}

# Play evolutions
play.evolutions.db.default.enabled = true
play.evolutions.db.default.autoApply = true

# JWT Configuration
jwt {
  secret = "fallback-secret-for-development-only"
  secret = ${?JWT_SECRET}
  expiration {
    hours = 24
    hours = ${?JWT_EXPIRATION_HOURS}
  }
  issuer = "trello-like"
  issuer = ${?JWT_ISSUER}
}

# Cookie Configuration
cookie {
  name = "auth-token"
  name = ${?COOKIE_NAME}
  maxAge = 86400
  maxAge = ${?COOKIE_MAX_AGE}
  secure = false
  secure = ${?COOKIE_SECURE}
  httpOnly = true
  httpOnly = ${?COOKIE_HTTP_ONLY}
  sameSite = "Strict"
  sameSite = ${?COOKIE_SAME_SITE}
}

# Which HttpFilters implementation to use:
play.http.filters = "filters.Filters"

# Disable default CSRF filter (we handle this in our custom filters)
filters.csrf.header.bypassHeaders {
    X-Requested-With = "*"
    Csrf-Token = "nocheck"
}

# Cache configuration for rate limiting
cache.defaultCache = "default"
cache.bindCaches = ["default"]

# Admin account configuration
admin {
    email = ${?ADMIN_EMAIL}
    password = ${?ADMIN_PASSWORD}
    name = ${?ADMIN_NAME}
}

# Custom error handler
play.http.errorHandler = "exception.CustomErrorHandler"

# Link preview api key
linkpreview.api.key = ${?LINK_PREVIEW_API_KEY}

# Data seeder configuration
seeder {
  numUsers = 30
  numUsers = ${?SEEDER_NUM_USERS}
  numWorkspaces = 4
  numWorkspaces = ${?SEEDER_NUM_WORKSPACES}
  projectsPerWorkspaceMin = 1
  projectsPerWorkspaceMin = ${?SEEDER_PROJECTS_PER_WORKSPACE_MIN}
  projectsPerWorkspaceMax = 3
  projectsPerWorkspaceMax = ${?SEEDER_PROJECTS_PER_WORKSPACE_MAX}
  totalTasksPerProject = 10000
  totalTasksPerProject = ${?SEEDER_TOTAL_TASKS_PER_PROJECT}
  taskBatch = 3000
  taskBatch = ${?SEEDER_TASK_BATCH}
}

play.mailer {
  host = "sandbox.smtp.mailtrap.io"
  host = ${?MAIL_HOST}
  port = 2525
  port = ${?MAIL_PORT}
  tls = yes
  ssl = no
  user = ""
  user = ${?MAIL_USER}
  password = ""
  password = ${?MAIL_PASSWORD}
}

logger.play.mailer = DEBUG

# frontend configuration
frontend {
  url = "http://localhost:3000"
  url = ${?FRONTEND_URL}
}
